"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("react/jsx-runtime"),s=require("@argent/x-shared"),F=require("../../../node_modules/.pnpm/@argent_x-shared@1.53.2_@scure_base@1.1.9_@scure_bip39@1.4.0_async-retry@1.3.3_lodash-es@4.17_k65wuhwgqgayjlfzx62kpc56xa/node_modules/@argent/x-shared/dist/src/features/swap/utils/slippage.cjs"),r=require("@chakra-ui/react"),g=require("react"),U=require("../../components/icons/FilterSecondaryIcon.cjs"),D=require("./SwapDetails.cjs"),E=require("./SwapSwitchDirectionButton.cjs"),O=require("./types.cjs"),y=require("../../components/CompoundDialogBottomSheet/index.cjs"),S=require("../../components/CompoundInput/index.cjs"),R=require("../../components/typography.generated.cjs");function _({assetSelect:p,slippage:t,pay:a,receive:m,onSwitchTokens:N,error:h,isDisabled:q,showDetails:A,trade:e,isLoadingTrade:c,submitButton:v={show:!0,type:"submit"}}){var I,w;const C=((I=t.options)==null?void 0:I.multiplier)||100,{isOpen:P,onOpen:d,onClose:f}=r.useDisclosure(),{isOpen:T,onOpen:M,onClose:b}=r.useDisclosure(),[k,u]=g.useMemo(function(){if(e){const o=s.bigDecimal.formatUnits({value:BigInt(e.payAmount),decimals:e.payToken.decimals??18}),i=s.bigDecimal.formatUnits({value:BigInt(e.receiveAmount),decimals:e.receiveToken.decimals??18}),x=s.prettifyCurrencyNumber(Number(i)/Number(o));let l=!!(e.payAmountInCurrency&&e.receiveAmountInCurrency&&Number(e.payAmountInCurrency)!==0&&Number(e.receiveAmountInCurrency)!==0)?(Number(e.payAmountInCurrency)-Number(e.receiveAmountInCurrency))/Number(e.receiveAmountInCurrency)*100:null;return l=l===null||l===0?l:l*-1,[x,l]}return[null,null]},[e]),j=g.useMemo(function(){var o;if(e){const{value:i,decimals:x}=F.minimumAmountOutFromTrade(e,t.value);return s.prettifyTokenAmount({amount:i,decimals:x,symbol:(o=e.receiveToken)==null?void 0:o.symbol})}},[e,t,(w=e==null?void 0:e.receiveToken)==null?void 0:w.symbol]),B=g.useMemo(function(){if(e){const o=[{property:"Swap fee",value:`${e.totalFeePercentage*100}%`},{property:"Min received (incl.fees)",value:`${j}`},{property:"Max slippage",value:(t.value/C).toString(),buttonProps:{icon:n.jsx(U,{}),"aria-label":"some label",onClick:M},alert:t.value/C>1?"Your transaction may be frontrun and result in an unfavorable trade":""},{property:"Providers",value:e.route.name}];return u?o.push({property:"Price impact",value:`${s.prettifyNumber(u)}%`,alert:u&&u<-1?"Your trade will have a significant impact on the price":""}):e&&u===null&&o.push({property:"Price impact",value:"",alert:"No price found, cannot determine price impact"}),o}return[]},[e,t,k,u,j]);return n.jsxs(n.Fragment,{children:[n.jsx(y.CompoundDialogBottomSheet,{isOpen:P,onClose:()=>f(),bottomSheetProps:{expandOnContentDrag:!0,snapPoints:({maxHeight:o})=>[o-(p.bottomSheetTopMargin??80)/2]},children:n.jsx(y.CompoundDialogBottomSheet.SelectAsset,{loading:p.loading,tokens:p.tokens,onSelect:o=>{p.onSelect(o),f()}})}),n.jsx(y.CompoundDialogBottomSheet,{isOpen:T,onClose:()=>b(),bottomSheetProps:{expandOnContentDrag:!0},children:n.jsx(y.CompoundDialogBottomSheet.SlippageInput,{onSave:o=>{t.onSave(o),b()},value:t.value,options:t.options})}),n.jsxs(r.Flex,{direction:"column",gap:"4",children:[n.jsxs(r.Flex,{w:"full",direction:"column",gap:"1",children:[n.jsxs(r.Flex,{pos:"relative",children:[n.jsx(S.CompoundInput,{amount:a.amount,token:{...a.token,onClick:o=>{var i;(i=a.token)==null||i.onClick(o),d()}},isLoading:a.isLoading,children:n.jsx(S.CompoundInput.Default,{title:"Pay"})}),n.jsx(E.SwapSwitchDirectionButton,{onClick:N})]}),n.jsx(S.CompoundInput,{amount:m.amount,token:{...m.token,onClick:o=>{var i;(i=m.token)==null||i.onClick(o),d()}},isLoading:m.isLoading,children:n.jsx(S.CompoundInput.Default,{title:"Receive"})})]}),!e&&c&&n.jsxs(r.Flex,{bg:"surface-elevated",justifyContent:"space-between",alignItems:"center",p:"4",rounded:"lg",fontWeight:"500",children:[n.jsx(R.P3,{children:" Finding the best rate..."}),n.jsx(r.Spinner,{})]}),A&&e&&n.jsx(D.SwapDetails,{children:n.jsx(D.SwapDetails.Default,{header:{primary:{property:"Best price",value:`1 ${e.payToken.symbol} = ${k} ${e.receiveToken.symbol}`},secondary:{property:c?"Updating quote":"Quote up-to-date",icon:c?n.jsx(r.Spinner,{w:"2",h:"2"}):void 0}},items:B})})]}),v.show&&n.jsx(r.Button,{type:v.type,onClick:v.onClick,colorScheme:!c&&h&&![O.SwapInputError.NO_TOKEN,O.SwapInputError.NO_AMOUNT].includes(h)?"danger":"primary",w:"full",isDisabled:q,children:c?"Loading...":h||"Review swap"})]})}exports.Swap=_;
