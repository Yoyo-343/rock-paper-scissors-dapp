"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const s=require("react/jsx-runtime"),d=require("@chakra-ui/react"),S=require("lightweight-charts"),w=require("lodash-es"),r=require("react"),a=require("../icons/EmptyFaceIcon.cjs");require("../Typography.cjs");const I=require("./utils.cjs"),T=require("../typography.generated.cjs"),z=({tokenGraphData:c,isLoading:x,chartOptions:h,getSeriesConfig:C,markerColor:g,asset:H,onCrosshairMove:u=w.noop,children:E,...R})=>{const i=r.useRef(null),o=r.useRef(null),t=r.useRef(null),j=d.useColorModeValue("neutrals.400","neutrals.300"),q=!x&&w.isEmpty(c==null?void 0:c.prices),F=`${h.height}px`,p=r.useCallback(()=>{var e;(e=o.current)==null||e.applyOptions({color:"#FFFFFF4D"})},[]),y=r.useCallback(()=>{var n,l;if(!o.current)return;const{prices:e}=I.buildTokenPrices({tokenGraphPrices:c==null?void 0:c.prices.map(f=>({time:f.date,value:f.ccyValue}))});(n=o.current)==null||n.setData(e??[]),(l=i.current)==null||l.timeScale().fitContent()},[c==null?void 0:c.prices]),b=r.useCallback(e=>{if(!t.current)return;const n=t.current.getBoundingClientRect();e.clientX>=n.left&&e.clientX<=n.right&&e.clientY>=n.top&&e.clientY<=n.bottom||u(void 0)},[u]);r.useEffect(()=>(window==null||window.addEventListener("mousemove",b),()=>{window==null||window.removeEventListener("mousemove",b)}),[b]);const m=r.useCallback(e=>{if(!(!t.current||!o.current))if(e.point===void 0||e.point.x<0||e.point.x>t.current.clientWidth||e.point.y<0||e.point.y>t.current.clientHeight)u(void 0);else{const n=e.seriesData.get(o.current),l=n==null?void 0:n.value,f=e.time;l&&f&&u({x:e.point.x,y:e.point.y,time:f,price:l,width:t.current.clientWidth,height:t.current.clientHeight})}},[u]),P=r.useCallback(e=>{t.current=e,t.current&&(i.current&&(i.current.unsubscribeCrosshairMove(m),i.current.remove()),i.current=S.createChart(t.current,h),o.current=i.current.addLineSeries(C(g)),i.current.subscribeCrosshairMove(m),y())},[h,C,y,g,m]),v=r.useCallback(()=>{var e;i.current&&(i.current.applyOptions({width:(e=t.current)==null?void 0:e.clientWidth}),i.current.timeScale().fitContent())},[]);return r.useEffect(()=>(window==null||window.addEventListener("resize",v),()=>{window==null||window.removeEventListener("resize",v)}),[v]),s.jsxs(d.Box,{minHeight:F,position:"relative",onTouchEnd:e=>{e.preventDefault(),u(void 0)},sx:{touchAction:"none"},onMouseEnter:p,...R,children:[!x&&s.jsx(d.Box,{ref:P,mx:"-4"}),q&&s.jsxs(d.Flex,{flexDir:"column",justifyContent:"center",alignItems:"center",h:"full",children:[s.jsx(d.Skeleton,{h:"90%",mx:5,borderRadius:"xl"})," ",s.jsx(a,{color:j,w:"5",h:"5",gap:"2"}),s.jsx(T.P3,{fontSize:"sm",fontWeight:"semibold",children:"No price available"})]}),x&&s.jsx(d.Skeleton,{h:"90%",mx:5,borderRadius:"xl"}),E]})};exports.TokenDetailsChart=z;
